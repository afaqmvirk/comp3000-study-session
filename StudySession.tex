\documentclass[11pt,letterpaper]{exam}

%----------------------------
% Encoding & Fonts (pdfLaTeX)
%----------------------------
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}

%----------------------------
% Page Layout & Formatting
%----------------------------
\usepackage[margin=1in]{geometry}
\usepackage{tabularx}
\usepackage{environ}
\usepackage{booktabs}
\usepackage{array}
\usepackage{multirow}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{graphicx}


\pagestyle{headandfoot}
\runningheadrule
\firstpageheadrule

\firstpageheader{Operating Systems}{Midterm Exam}{\today}
\runningheader{Operating Systems}{Midterm Exam}{Page \thepage\ of \numpages}
\runningfooter{}{}{}

% (All points-related commands removed)

%----------------------------
% Custom Environments & Commands
%----------------------------

% Multiple-choice question helper
% Optional arg kept for backward compatibility but IGNORED
\newcommand{\mcquestion}[3][]{%
  \question #2%
  \begin{choices}
    #3
  \end{choices}
}

% Multiple-choice question with square boxes instead of letter labels
\newcommand{\mcboxquestion}[3][]{%
  \question #2%
  {%
    % Local redefinition of the choice label to be a square box
    \renewcommand{\choicelabel}{\fbox{\rule{0pt}{1.5ex}\hspace{1.5ex}}}%
    \begin{choices}
      #3
    \end{choices}
  }%
}


% True/False (single statement with two checkboxes)
\newcommand{\tfquestion}[2][]{%
  \question #2
  \begin{checkboxes}
    \choice True
    \choice False
  \end{checkboxes}
}

% Matching section environment
% Uses two auto-wrapping columns (no overflow)
% Usage:
%   \begin{matching}
%     \mitem{A}{Process}{1}{A program in execution}
%   \end{matching}
\NewEnviron{matching}{%
  \begin{tabularx}{\textwidth}{@{}>{\raggedright\arraybackslash}X
                               >{\raggedright\arraybackslash}X@{}}
    \BODY
  \end{tabularx}
}

% Helper command for a row in matching
% Left side: label + term, Right side: label + definition
\newcommand{\mitem}[4]{%
  \textbf{#1.} #2 & \textbf{#3.} #4 \\[0.5em]
}

%-----------------------------------------
% Banker's Algorithm: matrices on same line
%-----------------------------------------
\newcommand{\bankersMatrices}{%
  \begin{center}
  \begin{tabular}{ccc}
    % Allocation
    \begin{tabular}{c|ccc}
      \multicolumn{4}{c}{\textbf{Allocation}} \\
      \toprule
      \textbf{P} & $R_1$ & $R_2$ & $R_3$ \\
      \midrule
      P0 &   &   &   \\
      P1 &   &   &   \\
      P2 &   &   &   \\
      P3 &   &   &   \\
      P4 &   &   &   \\
      \bottomrule
    \end{tabular}
    &
    % Max
    \begin{tabular}{c|ccc}
      \multicolumn{4}{c}{\textbf{Max}} \\
      \toprule
      \textbf{P} & $R_1$ & $R_2$ & $R_3$ \\
      \midrule
      P0 &   &   &   \\
      P1 &   &   &   \\
      P2 &   &   &   \\
      P3 &   &   &   \\
      P4 &   &   &   \\
      \bottomrule
    \end{tabular}
    &
    % Need
    \begin{tabular}{c|ccc}
      \multicolumn{4}{c}{\textbf{Need}} \\
      \toprule
      \textbf{P} & $R_1$ & $R_2$ & $R_3$ \\
      \midrule
      P0 &   &   &   \\
      P1 &   &   &   \\
      P2 &   &   &   \\
      P3 &   &   &   \\
      P4 &   &   &   \\
      \bottomrule
    \end{tabular}
  \end{tabular}
  \end{center}
  \vspace{1em}
}

% Available vector (kept separate)
\newcommand{\bankersAvailable}{%
  \begin{center}
  \textbf{Available Vector}\\[0.5em]
  \begin{tabular}{c|ccc}
    \toprule
    & \textbf{$R_1$} & \textbf{$R_2$} & \textbf{$R_3$} \\
    \midrule
    Available &   &   &   \\
    \bottomrule
  \end{tabular}
  \end{center}
  \vspace{1em}
}

% Short answer space using exam's \fillwithlines, with variable number of lines
\newcommand{\shortanswer}[3][1.0in]{%
  \question #3
  \vspace{0.5em}
  \fillwithlines{#1}
}

% Longer answer space
\newcommand{\longanswer}[2][]{%
  \question #2
  \vspace{0.5em}
  \fillwithlines{2.0in}
}

%----------------------------
% Exam Metadata
%----------------------------
\title{COMP 3000 Operating Systems}
\author{Study Session Questions}
\date{Date: \_\_\_/ \_\_\_/ \_\_\_}

%=========================================================
\begin{document}
%=========================================================

\maketitle

\vspace{1em}

\vspace{1em}
\noindent\textbf{Instructions:}
\begin{itemize}
  \item Answer all questions.
  \item Show all work for partial credit where appropriate.
  \item No electronic devices allowed.
\end{itemize}

% (gradetable removed)

%=========================================================
\newpage
\begin{questions}
%=========================================================

%----------------------------
% Part A: Multiple Choice
%----------------------------
\section*{Part 1 - Overview (OSC Ch. 1-2)}


\mcquestion{Which of the following statements are true? \textbf{Select all that apply.}}{%
  \choice An interrupt is ignored if another interrupt is currently being handled.
  \choice It's possible for two devices to each generate interrupts at the same time.
  \choice Division by zero always causes an interrupt.
  \choice All interrupts are generated only by hardware devices.
  \choice Disabling interrupts guarantees mutual exclusion on all systems.
  \choice A system call is an example of a software interrupt.
}

\mcboxquestion{Place the steps of interrupt handling in the correct order, from the beginning. (1, 2, 3, 4)}{%
\choice the CPU uses the interrupt vector table to find the right interrupt handler  
\choice the device controller/software sends the interrupt to CPU
  \choice the CPU restores its state and resumes normal operation
  \choice the CPU finishes its ongoing instruction and saves current program state
}

\mcboxquestion{Place the following storage systems in order of relative typical speed, from slowest to fastest. (1, 2, 3, 4)}{%
  \choice Hard-disk drives
  \choice Registers
  \choice Cache
  \choice Main memory
}

\question What is the main difference between an exception and an interrupt?

\fillwithlines{.5in}


\mcquestion{Consider the following list of actions. Which of the following should be performed by the kernel, and not by user programs? Select all that apply.}{
  \choice reading the value of the program counter (PC).
  \choice changing the value of the program counter (PC).
  \choice increasing the size of an address space.
  \choice creating a memory segment that is shared between multiple processes.
  \choice writing to a memory segment that is shared between multiple processes.
  \choice disabling interrupts.
}


\question Describe three primary functions of an operating system (what does it do?)

\fillwithlines{1.2in}

%----------------------------
% Part B: Matching
%----------------------------

\newpage
\section*{Part 2 - Process Management (OSC Ch. 3-5)}

\mcquestion{Which of the following statements are true? \textbf{Select all that apply.}}{%
  \choice It is possible to have concurrency \textbf{but not parallelism}.
  \choice Threads within the same process share the same \textbf{address space}.
  \choice The \textbf{Ready} queue contains processes that are waiting for I/O to complete.
  \choice In preemptive priority scheduling, starvation of low-priority processes is \textbf{impossible}.
  \choice A race condition occurs when the correctness of a program depends on the relative timing of threads.
  \choice A successful context switch \textbf{always} requires saving the state of the currently running process and restoring the state of the next process.
}


\question What is the use of the return value of \verb|fork()|?	

\fillwithlines{.5in}

\mcquestion{Which of the following is shared between threads of the same process? Select all that apply.}
{
  \choice integer and floating point registers
  \choice program counter
  \choice heap memory
  \choice stack memory
  \choice global variables
  \choice open files
}

\mcquestion{Under which of the following basic CPU scheduling policies is starvation possible? Select all that apply.}{
  \choice First-Come-First-Served (FCFS)
  \choice Shortest-Job-First (SJF)
  \choice Shortest-Remaining-Time-First (SRTF)
  \choice Round-Robin (RR)
}

\question What is \textit{context switching}?	

\fillwithlines{.5in}

\question What is the distinction between a ready thread and a waiting thread?


\fillwithlines{.5in}

\newpage
\mcquestion{Consider the following set of processes, with the length of the CPU burst time given in milliseconds:

\[
\begin{array}{c|c|c}
\text{Process} & \text{Burst Time} & \text{Priority} \\ \hline
P_1 & 2 & 2 \\
P_2 & 1 & 1 \\
P_3 & 8 & 4 \\
P_4 & 4 & 2 \\
P_5 & 5 & 3 \\
\end{array}
\]

The processes are assumed to have arrived in the order 
\( P_1, P_2, P_3, P_4, P_5 \), all at time 0.

Which of the following algorithms results in the minimum average waiting time (over all processes)?}{
  \choice First-Come-First-Served (FCFS)
  \choice Shortest-Job-First
  \choice Non-preemptive Priority (with a larger priority number implying a higher priority)
  \choice Round-Robin (quantum = 2)
}

Use the space below to justify your solution.

\newpage

\question A system uses an SRT (Shortest Remaining Time) scheduler. Among processes with the 
shortest remaining time, the earliest-arriving one is chosen.

Three processes arrive: $P_0$, $P_1$, and $P_2$.  
$P_0$ has a CPU burst of $4$ units,  
$P_1$ has a burst of $(1 + y)$ units,  
$P_2$ has a burst of $3$ units.  

The processes arrive at times $0$, $2$, and $5$ (one process at each time).

\begin{enumerate}
    \item[(a)] Determine the arrival order of $P_0$, $P_1$, and $P_2$.
    \item[(b)] Find the value of $y$ so that:
\end{enumerate}



\begin{itemize}
    \item SRT produces the \textbf{same} schedule as FCFS.
    \item The average response time of the three processes is \textbf{maximized}.
\end{itemize}

\textbf{Response time} is the time from arrival to first execution.

\newpage
%----------------------------
% Part C: Banker's Algorithm Tables
%----------------------------
\section*{Part 3 - Process Syncronization (OSC Ch. 6-8)} 


\question Match each term to the most accurate and precise defenition.


\begin{matching}
  \mitem{A}{Mutual Exclusion}{1}{Each process waits at most a finite number of turns.}
  \mitem{B}{Bounded Waiting}{2}{If the critical section is empty, waiting processes must eventually enter.}
  \mitem{C}{Progress}{3}{Only one process may be in its critical section.}
\end{matching}

\question (a) How could one PREVENT deadlock in the situation shown below using deadlock prevention techniques discussed in class?

\begin{center}
  \includegraphics[width=0.5\linewidth]{deadlock.jpeg}
  
  {\parbox{0.5\linewidth}{\centering\small Four buses blocking each other at the Alexander Klellands Plass intersection in Oslo, Norway. Photo dated 24 November 2025.}}
\end{center}

\fillwithlines{2in}

(b) Provide another (non-operating-system-related) example of deadlock.

\fillwithlines{1.5in}

\newpage

\question Consider the following information about resources in a system:
\begin{itemize}
  \item There are two classes of allocatable resource labelled R1 and R2.
  \item There are two instances of each resource.
  \item There are four processes labelled P1 through P4.
  \item There are some resource instances already allocated to processes, as follows:
  \begin{itemize}
    \item one instance of R1 held by P2, another held by P3
    \item one instance of R2 held by P1, another held by P4
  \end{itemize}
  \item Some processes have requested additional resources, as follows:
  \begin{itemize}
    \item P1 wants one instance of R1
    \item P3 wants one instance of R2
  \end{itemize}
\end{itemize}

(a) Draw the resource allocation graph for this system. Use the style of diagram from the lecture notes.


(b) What is the state (runnable, waiting) of each process? For each process that is waiting, indicate what it
is waiting for.


(c) Is this system deadlocked? If so, state which processes are involved. If not, give an execution sequence
that eventually ends, showing resource acquisition and release at each step.

\newpage



\question
Given the state below, determine whether the system is in a safe state. 
If it is safe, provide a safe sequence.


\bankersMatrices

\bankersAvailable



\newpage

\section*{Part 4 - Memory Management (OSC Ch. 9-10)}

\question Under what conditions might two or more processes share common physical frames? Explain how and why this would be done.

\fillwithlines{1in}

\question If every page in memory is accessed (used) between any two page faults, will the Clock replacement algorithm behave exatcly like FIFO? Justify your response whether true or false.

\fillwithlines{1in}

\question Assume that there are 5 pages, A, B, C, D, and E. Fill in the page reference
string and complete the rest of the information in the table below so that LRU is
the \emph{worst} page replacement algorithm (i.e., it results in the maximum
number of page faults). Use a dash ``--'' to fill in blank locations. Note that
when there is more than one page that is a possible victim, always choose the one
with the \textbf{lowest frame number}.

\begin{center}
\begin{tabular}{c|ccccccccccccccc}
 Num & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 & 15 \\ \hline
 Refs & A & B & C & D & E & & & & & & & & & & \\ \hline
 Frame 1 & A & & & & & & & & & & & & & & \\ 
 Frame 2 & -- & & & & & & & & & & & & & & \\ 
 Frame 3 & -- & & & & & & & & & & & & & & \\ 
 Frame 4 & -- & & & & & & & & & & & & & & \\ \hline
 Fault? & X & & & & & & & & & & & & & & \\
\end{tabular}
\end{center}

\newpage

\question Consider a virtual memory system that uses 2-level paging. The page size in this system is 256 $(2^8)$
bytes. Each individual page table fits exactly into one memory frame, and the size of each page table
entry (PTE) is 8 bytes.

(a) What is the maximum size (in bytes) of a virtual address space in this system?

\fillwithlines{0.5in}

(b) Suppose that there is a process with a virtual address space of the maximum size. How many
bytes of memory are occupied by the page tables for this process?

\fillwithlines{0.5in}

(c) Suppose that there is a process with a virtual address space of size 10240 $(10 \cdot 2^10)$ bytes. Also
suppose that the entire address space is in memory. How many valid PTEs will exist in the page
tables for this process?

\fillwithlines{0.5in}


\section*{Part 5 - Storage Management (OSC Ch. 11-12)}

% (You can add a custom multi-T/F macro here if youâ€™d like)

%----------------------------
% Part F: Short Answer
%----------------------------
\section*{Part 6 - File System (OSC Ch. 13-15)}


\section*{Part 8 - Virtual Machines (OSC Ch. 18)}

\end{questions}


\end{document}
